import { NextResponse, NextRequest } from 'next/server'; import { prisma } from '@/lib/prisma'; import { getSession } from '@/lib/session'; export async function GET(){ const s=await getSession(); if(!s.user) return new NextResponse('Unauthorized',{status:401}); const items=await prisma.contact.findMany({ where:{ userId:s.user.id }, orderBy:{ createdAt:'desc' } }); return NextResponse.json({ items }); } export async function POST(req: NextRequest){ const s=await getSession(); if(!s.user) return new NextResponse('Unauthorized',{status:401}); const b=await req.json(); const item=await prisma.contact.create({ data:{ userId:s.user.id, type:b.type, name:b.name, email:b.email??null, phone:b.phone??null, taxNo:b.taxNo??null, address:b.address??null } }); return NextResponse.json(item,{status:201}); }
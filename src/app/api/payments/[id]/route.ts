import { NextRequest, NextResponse } from 'next/server'; import { prisma } from '@/lib/prisma'; import { getSession } from '@/lib/session'; export async function PUT(req:NextRequest,{params}:{params:{id:string}}){ const s=await getSession(); if(!s.user) return new NextResponse('Unauthorized',{status:401}); const b=await req.json(); const item=await prisma.payment.update({ where:{ id:Number(params.id) }, data:{ contactId:b.contactId??null, invoiceId:b.invoiceId??null, accountId:b.accountId, date:new Date(b.date), amount:Number(b.amount||0), currency:b.currency, type:b.type, notes:b.notes??null } }); return NextResponse.json(item); } export async function DELETE(_req:NextRequest,{params}:{params:{id:string}}){ const s=await getSession(); if(!s.user) return new NextResponse('Unauthorized',{status:401}); await prisma.payment.delete({ where:{ id:Number(params.id) } }); return new NextResponse(null,{status:204}); }